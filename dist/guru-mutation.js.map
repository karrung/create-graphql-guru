{"version":3,"sources":["../src/guru-mutation.js"],"names":["promisifyAll","moduleRoot","process","cwd","dest","path","mkdir","program","database","fileName","methods","moduleName","resolverStr","createResolver","resolver","moduleFile","file","writeFileAsync","flag","then","console","log","yellow","catch","Error","error","createSchema","schema","options","schemaStr"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,mBAASA,YAAT;AACA,IAAMC,aAAgBC,QAAQC,GAAR,EAAhB,oBAAN;AACA,IAAMC,OAAO,wBAAQC,IAAR,GAAkBJ,UAAlB,SAAgC,wBAAQI,IAAxC,GAAiDJ,UAA9D;;IAEQK,K,qBAAAA,K;;YACkD,yBAAK;AAC7DC;AAD6D,CAAL,C;IAAlDC,Q,SAAAA,Q;IAAUC,Q,SAAAA,Q;IAAUC,O,SAAAA,O;IAASC,U,SAAAA,U;IAAYN,I,SAAAA,I;;AAIjD,IAAIO,oBAAJ;;AAEAN,MAAM,IAAN,EAAYD,IAAZ;;AAEA,SAASQ,cAAT,GAA2B;AACzB,MAAI,wBAAQC,QAAZ,EAAsB;AACpBF,kBAAc,6BAAS;AACrBJ,wBADqB;AAErBE,sBAFqB;AAGrBC;AAHqB,KAAT,CAAd;;AAMA,QAAMI,mCAAiCJ,UAAjC,IAA8CF,WAAW,MAAMA,QAAjB,GAA4B,EAA1E,SAAN;AACA,QAAMO,OAAUX,IAAV,SAAkBU,UAAxB;;AAEA,iBACGE,cADH,CACkBD,IADlB,EACwBJ,WADxB,EACqC,EAAEM,MAAM,IAAR,EADrC,EAEGC,IAFH,CAEQ,YAAM;AACVC,cAAQC,GAAR,CAAY,gBAAMC,MAAN,cAAwBP,UAAxB,CAAZ;AACD,KAJH,EAKGQ,KALH,CAKS,iBAAS;AACd,YAAM,IAAIC,KAAJ,CAAUC,KAAV,CAAN;AACD,KAPH;AAQD;AACF;;AAED,SAASC,YAAT,GAAyB;AACvB,MAAI,wBAAQC,MAAZ,EAAoB;AAClB,QAAMZ,iCAA+BJ,UAA/B,IAA4CF,WAAW,MAAMA,QAAjB,GAA4B,EAAxE,cAAN;AACA,QAAMO,OAAUX,IAAV,SAAkBU,UAAxB;AACA,QAAMa,UAAU,EAAEV,MAAM,IAAR,EAAhB;;AAEA,QAAMW,YAAYnB,UAAU,2BAAO,EAAEA,gBAAF,EAAWC,sBAAX,EAAP,CAAV,GAA4C,EAA9D;;AAEA,iBACGM,cADH,CACkBD,IADlB,EACwBa,SADxB,EACmCD,OADnC,EAEGT,IAFH,CAEQ,YAAM;AACVC,cAAQC,GAAR,CAAY,gBAAMC,MAAN,cAAwBP,UAAxB,CAAZ;AACD,KAJH,EAKGQ,KALH,CAKS,iBAAS;AACd,YAAM,IAAIC,KAAJ,CAAUC,KAAV,CAAN;AACD,KAPH;AAQD;AACF;;AAEDC;AACAb","file":"guru-mutation.js","sourcesContent":["import program, { args, resolver, schema } from './schema-helpers';\nimport Bluebird from 'bluebird';\nimport fs from 'fs';\nimport shell from 'shelljs';\nimport chalk from 'chalk';\n\nBluebird.promisifyAll(fs);\nconst moduleRoot = `${process.cwd()}/server/modules`;\nconst dest = program.path ? `${moduleRoot}/${program.path}` : moduleRoot;\n\nconst { mkdir } = shell;\nconst { database, fileName, methods, moduleName, path } = args({\n  program\n});\n\nlet resolverStr;\n\nmkdir('-p', path);\n\nfunction createResolver () {\n  if (program.resolver) {\n    resolverStr = resolver({\n      database,\n      methods,\n      moduleName\n    });\n\n    const moduleFile = `resolverMutation-${moduleName}${fileName ? '-' + fileName : ''}.js`;\n    const file = `${path}/${moduleFile}`;\n\n    fs\n      .writeFileAsync(file, resolverStr, { flag: 'wx' })\n      .then(() => {\n        console.log(chalk.yellow(`Created ${moduleFile}`));\n      })\n      .catch(error => {\n        throw new Error(error);\n      });\n  }\n}\n\nfunction createSchema () {\n  if (program.schema) {\n    const moduleFile = `schemaMutation-${moduleName}${fileName ? '-' + fileName : ''}.graphql`;\n    const file = `${path}/${moduleFile}`;\n    const options = { flag: 'wx' };\n\n    const schemaStr = methods ? schema({ methods, moduleName }) : '';\n\n    fs\n      .writeFileAsync(file, schemaStr, options)\n      .then(() => {\n        console.log(chalk.yellow(`Created ${moduleFile}`));\n      })\n      .catch(error => {\n        throw new Error(error);\n      });\n  }\n}\n\ncreateSchema();\ncreateResolver();\n"]}